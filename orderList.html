<!DOCTYPE html>
<html lang="en">
<div class="panel panel-default">
    <div class="panel-heading">
        <div class="panel-title">
            <h4>
                订单列表
            </h4>
        </div>
    </div>
    <div class="panel-body">
        <table class="table table-responsive table-hover">
            <thead>
            <tr>
                <th>订单号</th>
                <th>名称</th>
                <th>价格</th>
                <th>提交时间</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>
</div>
<script>
    $(function () {
        listOrder()
    })

    function listOrder() {
        table = $('tbody');
        table.html('');
        $.ajax({
            type: "get",
            url: host + "/order/order/",
            xhrFields:{
                withCredentials: true
            },
            success: function (msg) {
                if(msg.code == 401){
                    alert("未登录")
                    window.location.href = "login.html"
                }
                if(msg.code == 400){
                    table = $('tbody');
                    table.html('');
                }
                data = msg.data;
                for (i in data) {
                    part = data[i].computerPart;
                    order = data[i].computerOrder;
                    html = "<tr onclick=\"modalShow('"+i+"')\">"
                    html += '<td>' + order.orderId + '</td>';
                    html += '<td>' + part.partTableName + '</td>';
                    html += '<td>' + order.price + '</td>';
                    html += '<td>' + part.createTime + '</td>';
                    html += '</tr>';
                    table.append(html)
                }
            },
            error: function (msg) {
                alert("无法连接到服务器，请重新尝试")
                table = $('tbody');
                table.html('');
            }
        })
    }

</script>